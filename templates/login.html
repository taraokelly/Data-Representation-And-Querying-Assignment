<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Bootstrap's css, stored in file: static -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    {% if error %}
   <link rel = "stylesheet" href="{{ url_for('static', filename='lib/bootstrap/dist/css/bootstrap.css') }}">
   <script src="{{ url_for('static', filename='lib/jquery/dist/jquery.js') }}"></script>
   <script src="{{ url_for('static', filename='lib/bootstrap/dist/js/bootstrap.min.js') }}"></script>
   {% else %}
   <link rel = "stylesheet" href="static/lib/bootstrap/dist/css/bootstrap.css">
   <script src="static/lib/jquery/dist/jquery.js"></script>
   <script src="static/lib/bootstrap/dist/js/bootstrap.min.js"></script>
   {% endif %}
   <title>TheFeed</title>
   <nav class="navbar navbar-full navbar-dark bg-primary">
   		<br/>
   		 {% if error %}
   		 <a class="navbar-brand" href="#">
			<img src="{{ url_for('static', filename='TheFeed1.png') }}">	
	  	</a>
   		 {% else %}
  		<a class="navbar-brand" href="#">
			<img src="/static/TheFeed1.png">
	  	</a>
	  	{% endif %}
		<div class="pull-right">
	        <ul class="nav navbar-nav">
	            <li>	
		    	<form class ="form-inline float-xs-right">	
					<div class="form-group">
						<label for="name">Username:</label> 
						<input type="text" class="form-control" id= "name">
					</div> 	
					<div class="form-group">
						<label for="name">Password:</label> 
						<input type="password" class="form-control" id= "pass">
					</div>
					<button type="submit" id="submit" class="btn btn-primary"> Login </button> 
				</form>
			</li>
	        </ul>     
		</div>
	</nav>
  </head>
  <body>
	
	<div class="container">
		<br/>
		{% if error %}
		<div class="alert alert-danger" role="alert">
		  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
		  <span class="sr-only">Error:</span>
		 	{{ error }}
		</div>
		<br/>
		{% endif %}

		<h3>Don't have an account? Sign up!</h3>
		<hr><br/>
		<form>
				<div class="form-group">
					<label for="name">Create Username:</label> 
					<input type="text" class="form-control" id= "newName">
				</div> 
				<div class="form-group">
					<label for="name">Create Password:</label> 
					<input type="password" class="form-control" id= "newPass">
				</div> 
				<div class="form-group">
					<label for="name">Re-Enter Password:</label> 
					<input type="password" class="form-control" id= "checkPass">
				</div> 
				<button type="submit" id="register" class="btn btn-success" > Sign Up </button> 
			</form>
	</div>
	<!-- Modal -->
	<!-- Adapted from http://stackoverflow.com/questions/28924551/how-to-open-bootstrap-modal-in-ajax-success -->
	 <div class="modal fade" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	   <div class="modal-dialog modal-sm">
	      <div class="modal-content">
	       <div class="modal-header">
	         <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	         <h4 class="modal-title" id="myModalLabel"></h4>
	       </div>
	       <div class="modal-body" id="myModelBody" style="overflow-x: scroll;">
	          <p>Your user account has been successfully added. Please login to continue.</p>
	       </div>
	    </div>
	   </div>
	 </div>
	<script type="text/javascript">
	$("#submit").click(function(e) {
		e.preventDefault();
		data = {userinput: $("#name").val(), password: $("#pass").val()}
		$.post("/name", data, function(resbody)
			{
				window.location = resbody;
		});
	});
	$("#register").click(function(e) {
		e.preventDefault();
		data = {user: $("#newName").val(), pass: $("#newPass").val(), pass1: $("#checkPass").val()}
		$.post("/register", data, function(resbody)
			{
				// Adapted from http://www.w3schools.com/Jsref/jsref_localecompare.asp
				var str1 = "/Error/Passwords Do Not Match";
				var str2 = "/Error/Username Already Exists"
				if(str1.localeCompare(resbody) == 0 || str2.localeCompare(resbody) == 0)
					window.location = resbody;
				else
				//Adapted from http://stackoverflow.com/questions/28924551/how-to-open-bootstrap-modal-in-ajax-success
					$("#signUpModal").modal("toggle");
       				$("#myModalLabel").html(resbody);

		});
	});
	</script>
 </body>
</html>